#!/system/bin/sh

#
# Copyright (C) 2024-2025 Zexshia
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

MODDIR=${0%/*}
file="/data/adb/.config/encore/current_profile"
value=$(cat "$file" 2>/dev/null)

zeshia() {
	if [ -f $2 ]; then
		chmod 644 $2 >/dev/null 2>&1
		echo $1 >$2 2>/dev/null
		chmod 444 $2 >/dev/null 2>&1
	fi
}
# Logging 
sendlog() {
    local LEVEL="$1"
    local MODULE="$2"
    local MESSAGE="$3"
    local TIMESTAMP
    TIMESTAMP="$(date '+%Y-%m-%d %H:%M:%S.%3N')"
    echo "$TIMESTAMP $LEVEL $MODULE: $MESSAGE" >> /data/adb/.config/encore/encore.log
}
####################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################

AZenith_Powersave() {

# PPM Settings
if [ -d /proc/ppm ]; then
    if [ -f /proc/ppm/policy_status ]; then
        for idx in $(grep -E 'FORCE_LIMIT|PWR_THRO|THERMAL|USER_LIMIT' /proc/ppm/policy_status | awk -F'[][]' '{print $2}'); do
            zeshia "1" "/proc/ppm/policy_status"
        done
        
        for dx in $(grep -E 'SYS_BOOST' /proc/ppm/policy_status | awk -F'[][]' '{print $2}'); do
            zeshia "0" "/proc/ppm/policy_status"
        done
    fi
fi

# Power level settings
for pl in /sys/devices/system/cpu/perf; do
    zeshia 0 "$pl/gpu_pmu_enable"
    zeshia 0 "$pl/fuel_gauge_enable"
    zeshia 0 "$pl/enable"
    zeshia 1 "$pl/charger_enable"
done


# Limit cpu freq
cpufrequency() {
    if [ -d /proc/ppm ]; then
        cluster=0
        for path in /sys/devices/system/cpu/cpufreq/policy*; do
            cpu_maxfreq=$(cat "$path/cpuinfo_max_freq")

            new_maxfreq=$((cpu_maxfreq * $limiter / 100))
            new_minfreq=$((cpu_maxfreq * 40 / 100))

            zeshia "$cluster $new_maxfreq" "/proc/ppm/policy/hard_userlimit_max_cpu_freq"
            zeshia "$cluster $new_minfreq" "/proc/ppm/policy/hard_userlimit_min_cpu_freq"
            ((cluster++))
        done
    fi

  
    for path in /sys/devices/system/cpu/cpufreq/policy*; do
        [ -f "$path/cpuinfo_max_freq" ] || continue
        cpu_maxfreq=$(cat "$path/cpuinfo_max_freq")

        new_maxfreq=$((cpu_maxfreq * $limiter / 100))
        new_minfreq=$((cpu_maxfreq * 40 / 100))

        zeshia "$new_maxfreq" "$path/scaling_max_freq"
        zeshia "$new_minfreq" "$path/scaling_min_freq"
    done
}
cpufrequency

# Cache Pressure
zeshia "30" "/proc/sys/vm/vfs_cache_pressure"

# Restore UFS Governor
for path in /sys/class/devfreq/*.ufshc; do
    zeshia "simple_ondemand" "$path/governor"
    
done

# cpufreq cci
zeshia "0" "/proc/cpufreq/cpufreq_cci_mode"
zeshia "1" "/proc/cpufreq/cpufreq_power_mode"


# GPU Frequency
if [ -d /proc/gpufreq ]; then
		zeshia "0" /proc/gpufreq/gpufreq_opp_freq
elif [ -d /proc/gpufreqv2 ]; then
		zeshia "-1" /proc/gpufreqv2/fix_target_opp_index
fi

# UFS governor 
zeshia "0" "/sys/devices/platform/10012000.dvfsrc/helio-dvfsrc/dvfsrc_req_ddr_opp"         
zeshia "0" "/sys/kernel/helio-dvfsrc/dvfsrc_force_vcore_dvfs_opp"                          
zeshia "powersave" "/sys/class/devfreq/mtk-dvfsrc-devfreq/governor"                      
zeshia "powersave" "/sys/devices/platform/soc/1c00f000.dvfsrc/mtk-dvfsrc-devfreq/devfreq/mtk-dvfsrc-devfreq/governor"

# GPU Power limiter - Performance mode (not for Powersave)
[ -f "/proc/gpufreq/gpufreq_power_limited" ] && {
	for setting in ignore_batt_oc ignore_batt_percent ignore_low_batt ignore_thermal_protect ignore_pbm_limited; do
		zeshia "$setting 1" /proc/gpufreq/gpufreq_power_limited
	done
}

# Disable PBM
zeshia "stop 1" /proc/pbm/pbm_stop

# Enable battery current limiter
zeshia "stop 1" /proc/mtk_batoc_throttling/battery_oc_protect_stop

# Workqueue settings
zeshia "Y" /sys/module/workqueue/parameters/power_efficient
zeshia "Y" /sys/module/workqueue/parameters/disable_numa
zeshia "1" /sys/kernel/eara_thermal/enable
zeshia "1" /sys/devices/system/cpu/eas/enable


# Adaptive power saver
cmd power set-adaptive-power-saver-enabled true
cmd power set-fixed-performance-mode-enabled false

zeshia 30 /proc/sys/kernel/perf_cpu_time_max_percent
zeshia 1 /proc/sys/kernel/sched_energy_aware

#  Enable battery saver module    
[ -f /sys/module/battery_saver/parameters/enabled ] && {    
	if grep -qo '[0-9]\+' /sys/module/battery_saver/parameters/enabled; then    
		zeshia 1 /sys/module/battery_saver/parameters/enabled    
	else    
		zeshia Y /sys/module/battery_saver/parameters/enabled    
	fi    
}    
 

# Schedfeature settings - Powersave Mode
if [ -f "/sys/kernel/debug/sched_features" ]; then  
	zeshia NO_NEXT_BUDDY /sys/kernel/debug/sched_features     
	zeshia NO_TTWU_QUEUE /sys/kernel/debug/sched_features    
fi

#Disable CPU in Powersave
zeshia "0" /sys/devices/system/cpu/cpu2/online

}

###############################################################################################################################################################################################################################################################################################################

AZenith_Performance() {
# Enable CPU 
zeshia "1" /sys/devices/system/cpu/cpu2/online        
    
# PPM Settings
if [ -d /proc/ppm ]; then
    if [ -f /proc/ppm/policy_status ]; then
        for idx in $(grep -E 'FORCE_LIMIT|PWR_THRO|THERMAL|USER_LIMIT' /proc/ppm/policy_status | awk -F'[][]' '{print $2}'); do
            zeshia "0" /proc/ppm/policy_status
        done
        
        for dx in $(grep -E 'SYS_BOOST' /proc/ppm/policy_status | awk -F'[][]' '{print $2}'); do
            zeshia "1" /proc/ppm/policy_status
        done
    fi
fi


# Power level settings
for pl in /sys/devices/system/cpu/perf; do
    zeshia 1 "$pl/gpu_pmu_enable"
    zeshia 1 "$pl/fuel_gauge_enable"
    zeshia 1 "$pl/enable"
    zeshia 1 "$pl/charger_enable"
done


# Cache Pressure 
zeshia "100" "/proc/sys/vm/vfs_cache_pressure"

zeshia "1" "/proc/cpufreq/cpufreq_cci_mode"
zeshia "3" "/proc/cpufreq/cpufreq_power_mode"        
	
# UFS Governor's
zeshia "0" "/sys/devices/platform/10012000.dvfsrc/helio-dvfsrc/dvfsrc_req_ddr_opp"
zeshia "0" "/sys/kernel/helio-dvfsrc/dvfsrc_force_vcore_dvfs_opp"
zeshia "performance" "/sys/class/devfreq/mtk-dvfsrc-devfreq/governor"
zeshia "performance" "/sys/devices/platform/soc/1c00f000.dvfsrc/mtk-dvfsrc-devfreq/devfreq/mtk-dvfsrc-devfreq/governor"
for path in /sys/class/devfreq/*.ufshc; do
    zeshia "performance" "$path/governor"
    sleep 0.5
done

zeshia "3" "/proc/sys/vm/drop_caches"

	# EAS/HMP Switch
	zeshia "0" /sys/devices/system/cpu/eas/enable

	# Disable GPU Power limiter
	[ -f "/proc/gpufreq/gpufreq_power_limited" ] && {
		for setting in ignore_batt_oc ignore_batt_percent ignore_low_batt ignore_thermal_protect ignore_pbm_limited; do
			zeshia "$setting 1" /proc/gpufreq/gpufreq_power_limited
		done
	}

	# Disable battery current limiter
	zeshia "stop 1" /proc/mtk_batoc_throttling/battery_oc_protect_stop

	# Eara Thermal
	zeshia "0" /sys/kernel/eara_thermal/enable
	
# Workqueue settings
zeshia "N" /sys/module/workqueue/parameters/power_efficient
zeshia "N" /sys/module/workqueue/parameters/disable_numa
zeshia "0" /sys/kernel/eara_thermal/enable
zeshia "0" /sys/devices/system/cpu/eas/enable

# Schedtune Settings
for path in /dev/stune/*; do
    base=$(basename "$path")  
    if [[ "$base" == "top-app" || "$base" == "foreground" ]]; then
        zeshia 30 "$path/schedtune.boost"
        zeshia 1 "$path/schedtune.sched_boost_enabled"
    else
        zeshia 30 "$path/schedtune.boost"
        zeshia 1 "$path/schedtune.sched_boost_enabled"
    fi  
    zeshia 0 "$path/schedtune.prefer_idle"
    zeshia 0 "$path/schedtune.colocate"
done

# Power level settings
for pl in /sys/devices/system/cpu/perf; do
    zeshia 1 "$pl/gpu_pmu_enable"
    zeshia 1 "$pl/fuel_gauge_enable"
    zeshia 1 "$pl/enable"
    zeshia 1 "$pl/charger_enable"
done

# Adaptive power saver
cmd power set-adaptive-power-saver-enabled false
cmd power set-fixed-performance-mode-enabled true

zeshia "0" /proc/perfmgr/syslimiter/syslimiter_force_disable
zeshia "stop 1" /proc/mtk_batoc_throttling/battery_oc_protect_stop

zeshia 3 /proc/sys/kernel/perf_cpu_time_max_percent
zeshia 1 /proc/sys/kernel/sched_energy_aware

for cpucore in /sys/devices/system/cpu/cpu[1-7]; do
    zeshia 0 "$cpucore/core_ctl/enable"
    zeshia 0 "$cpucore/core_ctl/core_ctl_boost"
done

# MTK FPSGo advanced parameters
for param in boost_affinity boost_LR gcc_hwui_hint; do
    zeshia "1" "/sys/module/mtk_fpsgo/parameters/$param"
done

clear_background_apps() {

app_list=$(top -n 1 -o %CPU | awk 'NR>7 {print $1}' | while read -r pid; do
    pkg=$(cmd package list packages -U | awk -v pid="$pid" '$2 == pid {print $1}' | cut -d':' -f2)
    if [ -n "$pkg" ] && ! echo "$pkg" | grep -qE "com.android.systemui|com.android.settings|$(basename "$0")"; then
        echo "$pkg"
    fi
done)

# Kill apps in order of highest CPU usage
for app in $app_list; do
    am force-stop "$app"
done
    
# force stop
am force-stop com.instagram.android
am force-stop com.android.vending
am force-stop app.grapheneos.camera
am force-stop com.google.android.gm
am force-stop com.google.android.apps.youtube.creator
am force-stop com.dolby.ds1appUI
am force-stop com.google.android.youtube
am force-stop com.twitter.android
am force-stop nekox.messenger
am force-stop com.shopee.id
am force-stop com.vanced.android.youtube
am force-stop com.speedsoftware.rootexplorer
am force-stop com.bukalapak.android
am force-stop org.telegram.messenger
am force-stop ru.zdevs.zarchiver
am force-stop com.android.chrome
am force-stop com.whatsapp.messenger
am force-stop com.google.android.GoogleCameraEng
am force-stop com.facebook.orca
am force-stop com.lazada.android
am force-stop com.android.camera
am force-stop com.android.settings
am force-stop com.franco.kernel
am force-stop com.telkomsel.telkomselcm
am force-stop com.facebook.katana
am force-stop com.instagram.android
am force-stop com.facebook.lite
am kill-all


sendlog "I" "ZireliaAddons" "Killed Background apps"
}


if [ "$(cat /data/adb/.config/zirelia/clearbg)" -eq 1 ]; then
   clear_background_apps
fi

ioscheduling() {        

        pidget=$(cut -d ' ' -f2 /data/adb/.config/encore/gameinfo)
        sendlog "D" "ZireliaAddons" "Applying io scheduling priority to PID: $pidget"
        for pid in $pidget; do
            renice -n -10 -p "$pid"
            ionice -c 1 -n 0 -p "$pid"
            chrt -f -p 99 "$pid"            
        done
              
}

if [ "$(cat /data/adb/.config/zirelia/iosched)" -eq 1 ]; then
   ioscheduling
fi

# Disable battery saver module  
[ -f /sys/module/battery_saver/parameters/enabled ] && {  
	if grep -qo '[0-9]\+' /sys/module/battery_saver/parameters/enabled; then  
		zeshia 0 /sys/module/battery_saver/parameters/enabled  
	else  
		zeshia N /sys/module/battery_saver/parameters/enabled  
	fi  
}

# Disable split lock mitigation  
zeshia 0 /proc/sys/kernel/split_lock_mitigate  

# Schedfeatures settings
if [ -f "/sys/kernel/debug/sched_features" ]; then  
	zeshia NEXT_BUDDY /sys/kernel/debug/sched_features  
	zeshia NO_TTWU_QUEUE /sys/kernel/debug/sched_features  
fi  

}

######################################################################################################################################################

AZenith_Normal() {

# Enable CPU 
zeshia "1" /sys/devices/system/cpu/cpu2/online

# PPM Settings
if [ -d /proc/ppm ]; then
    if [ -f /proc/ppm/policy_status ]; then
        for idx in $(grep -E 'FORCE_LIMIT|PWR_THRO|THERMAL|USER_LIMIT' /proc/ppm/policy_status | awk -F'[][]' '{print $2}'); do
            zeshia "1" "/proc/ppm/policy_status"
        done
        
        for dx in $(grep -E 'SYS_BOOST' /proc/ppm/policy_status | awk -F'[][]' '{print $2}'); do
            zeshia "0" "/proc/ppm/policy_status"
        done
    fi
fi

# Power level settings
for pl in /sys/devices/system/cpu/perf; do
    zeshia 0 "$pl/gpu_pmu_enable"
    zeshia 0 "$pl/fuel_gauge_enable"
    zeshia 0 "$pl/enable"
    zeshia 1 "$pl/charger_enable"
done

zeshia "120" "/proc/sys/vm/vfs_cache_pressure"

# Restore UFS Governor
for path in /sys/class/devfreq/*.ufshc; do
    zeshia "simple_ondemand" "$path/governor"
    
done

# Restore Power & Thermal Policies
if [ -d /proc/ppm ]; then
    for idx in $(grep -E 'PWR_THRO|THERMAL' /proc/ppm/policy_status | awk -F'[][]' '{print $2}'); do
        zeshia "$idx 1" "/proc/ppm/policy_status"
        sleep 0.5
    done
fi

# cpufreq cci
zeshia "0" "/proc/cpufreq/cpufreq_cci_mode"

zeshia "1" "/proc/cpufreq/cpufreq_power_mode"


# GPU Frequency
if [ -d /proc/gpufreq ]; then
		zeshia "0" /proc/gpufreq/gpufreq_opp_freq
elif [ -d /proc/gpufreqv2 ]; then
		zeshia "-1" /proc/gpufreqv2/fix_target_opp_index
fi

# Restore UFS governor 
zeshia "-1" "/sys/devices/platform/10012000.dvfsrc/helio-dvfsrc/dvfsrc_req_ddr_opp"

zeshia "-1" "/sys/kernel/helio-dvfsrc/dvfsrc_force_vcore_dvfs_opp"

zeshia "userspace" "/sys/class/devfreq/mtk-dvfsrc-devfreq/governor"

zeshia "userspace" "/sys/devices/platform/soc/1c00f000.dvfsrc/mtk-dvfsrc-devfreq/devfreq/mtk-dvfsrc-devfreq/governor"



	# EAS/HMP Switch
	zeshia "1" /sys/devices/system/cpu/eas/enable

	# GPU Power limiter
	[ -f "/proc/gpufreq/gpufreq_power_limited" ] && {
		for setting in ignore_batt_oc ignore_batt_percent ignore_low_batt ignore_thermal_protect ignore_pbm_limited; do
			zeshia "$setting 0" /proc/gpufreq/gpufreq_power_limited
		done
	}

	# Enable Power Budget management for new 5.x mtk kernels
	zeshia "stop 0" /proc/pbm/pbm_stop

	# Enable battery current limiter
	zeshia "stop 0" /proc/mtk_batoc_throttling/battery_oc_protect_stop

	# Eara Thermal
	zeshia "1" /sys/kernel/eara_thermal/enable
	
	sleep 0.2

# Workqueue settings
zeshia "Y" /sys/module/workqueue/parameters/power_efficient
zeshia "Y" /sys/module/workqueue/parameters/disable_numa
zeshia "1" /sys/kernel/eara_thermal/enable
zeshia "1" /sys/devices/system/cpu/eas/enable


	
for path in /dev/stune/*; do
    base=$(basename "$path")  
    if [[ "$base" == "top-app" || "$base" == "foreground" ]]; then
        zeshia 0 "$path/schedtune.boost"
        zeshia 0 "$path/schedtune.sched_boost_enabled"
    else
        zeshia 0 "$path/schedtune.boost"
        zeshia 0 "$path/schedtune.sched_boost_enabled"
    fi  
    zeshia 0 "$path/schedtune.prefer_idle"
    zeshia 0 "$path/schedtune.colocate"
done

cmd power set-fixed-performance-mode-enabled false

# Power level settings
for pl in /sys/devices/system/cpu/perf; do
    zeshia 0 "$pl/gpu_pmu_enable"
    zeshia 0 "$pl/fuel_gauge_enable"
    zeshia 0 "$pl/enable"
    zeshia 1 "$pl/charger_enable"
done

# Adaptive power saver
cmd power set-adaptive-power-saver-enabled true
cmd power set-fixed-performance-mode-enabled false

zeshia "0" /proc/perfmgr/syslimiter/syslimiter_force_disable
zeshia "stop 0" /proc/mtk_batoc_throttling/battery_oc_protect_stop

zeshia 40 /proc/sys/kernel/perf_cpu_time_max_percent
zeshia 1 /proc/sys/kernel/sched_energy_aware

for cpucore in /sys/devices/system/cpu/cpu[1-7]; do
    zeshia 0 "$cpucore/core_ctl/enable"
    zeshia 0 "$cpucore/core_ctl/core_ctl_boost"
done
sleep 0.2

#  Disable battery saver module    
[ -f /sys/module/battery_saver/parameters/enabled ] && {    
	if grep -qo '[0-9]\+' /sys/module/battery_saver/parameters/enabled; then    
		zeshia 0 /sys/module/battery_saver/parameters/enabled    
	else    
		zeshia N /sys/module/battery_saver/parameters/enabled    
	fi    
}    

#  Enable split lock mitigation    
zeshia 1 /proc/sys/kernel/split_lock_mitigate    

if [ -f "/sys/kernel/debug/sched_features" ]; then    
	#  Consider scheduling tasks that are eager to run    
	zeshia NEXT_BUDDY /sys/kernel/debug/sched_features    

	#  Schedule tasks on their origin CPU if possible    
	zeshia TTWU_QUEUE /sys/kernel/debug/sched_features    
fi    

}

# Profiler
if [ "$value" = "1" ]; then
    AZenith_Performance
elif [ "$value" = "2" ]; then    
    AZenith_Normal
elif [ "$value" = "3" ]; then   
    AZenith_Powersave
fi

exit 0

##########################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################